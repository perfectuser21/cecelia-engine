---
id: dod-fix-critical-issues
version: 1.0.0
created: 2026-01-23
updated: 2026-01-23
changelog:
  - 1.0.0: 初始版本
---

# DoD - 修复 CRITICAL 级安全问题

QA: docs/QA-DECISION.md

## 验收标准

### 1. Hooks 安全
- [x] branch-protect.sh JSON 预验证
  Test: manual:code-review
- [x] branch-protect.sh realpath -s + 路径遍历检查
  Test: manual:code-review
- [x] pr-gate-v2.sh JSON 预验证
  Test: manual:code-review
- [x] pr-gate-v2.sh sed 使用 # 分隔符
  Test: manual:code-review

### 2. Scripts 安全
- [x] run-regression.sh id 格式白名单验证
  Test: manual:code-review
- [x] qa-report.sh printf 替代 echo + jq 转义
  Test: manual:code-review

### 3. CI 安全
- [x] nightly.yml notify Job 权限声明
  Test: manual:code-review
- [x] nightly.yml curl 使用 jq 生成 JSON
  Test: manual:code-review
- [x] nightly.yml git push 错误检查
  Test: manual:code-review
- [x] ci.yml notify-failure Job 权限声明
  Test: manual:code-review
- [x] ci.yml curl 使用 jq 生成 JSON
  Test: manual:code-review

### 4. 文档修复
- [x] dev/SKILL.md 补充完整步骤追踪 (Step 2 + 7-11)
  Test: manual:code-review

### 5. 质量验收
- [x] npm run qa 通过 (113 tests)
  Test: contract:C2-001
