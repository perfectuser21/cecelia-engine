# PRD: Evidence CI 化（SSOT）

> Release: v10.11.0
> Status: Completed

---

## 背景

当前问题：
- Evidence 文件被提交到 git，导致 SHA drift
- 本地修改代码后，Evidence SHA ≠ 当前 commit SHA
- 手动重新生成 Evidence 很繁琐，容易忘记

---

## 目标

**核心目标**：Evidence 完全由 CI 生成，不再提交到 git

**次要目标**：
- 本地开发 Fast Fail（只跑 typecheck，5-10秒）
- CI 自动生成 Evidence（完整测试 + Evidence 生成）
- 消除 SHA drift 问题

---

## 方案

### 1. CI Evidence 生成

新增脚本：`ci/scripts/generate-evidence.sh`
- 只在 CI 环境运行
- 生成 `.quality-evidence.<SHA>.json`
- SHA = HEAD commit SHA

### 2. CI Evidence 校验

新增脚本：`ci/scripts/evidence-gate.sh`
- 校验 Evidence 文件存在
- 校验 SHA 匹配
- 校验 JSON 格式

### 3. 本地 Fast Fail

`package.json`:
```json
{
  "qa:local": "npm run typecheck"
}
```

### 4. .gitignore 更新

忽略所有 Evidence 文件：
```
.quality-evidence*.json
.quality-gate-passed
```

---

## 验收标准

见 `.dod.md`

---

## RCI 映射

- C8-001: CI Evidence 生成脚本
- C8-002: CI Evidence 校验脚本
- C8-003: 本地 Fast Fail

---

## 影响范围

- **CI Workflow**：新增 Evidence 生成和校验步骤
- **本地开发**：`npm run qa:local` 只跑 typecheck
- **Git**: Evidence 文件不再提交

---

## 版本

v2.0.0 - 重大变更（Evidence 生成方式变更）
