# PRD - /dev Skills 清理 + 多 Feature 支持

## 需求来源

用户反馈：当前 /dev 步骤文件中存在垃圾提示词（"等用户确认"、"停下来"等），导致执行过程中不必要的停顿，破坏了 v2.0 的两阶段设计（只在 PR 后和 CI 检查时停止）。同时需要增强 /dev 支持多 Feature 迭代开发。

## 功能描述

### 1. 清理垃圾提示词

**问题文件**：
- `skills/dev/steps/01-prd.md`: "等用户确认"、"用户确认后才能继续"
- `skills/dev/steps/05-code.md`: "停下来，和用户确认"
- `skills/dev/steps/02.5-parallel-detect.md`: "询问是否继续"（整个文件可能不需要）

**清理原则**：
- 删除所有"等待"、"确认"、"停止"、"询问"指示
- 改为连续执行，信任 Claude 自己判断
- 保留必要的说明，删除过度干涉的指示

### 2. 简化/删除并行检测

`02.5-parallel-detect.md` 当前要求询问用户选择 worktree，但用户表示：
- 一次只做一个任务（不会并行）
- 应该自动检测并决策，不询问用户

**方案**：简化为自动检测逻辑，或直接删除（可选步骤）

### 3. 增强多 Feature 支持

支持复杂任务拆分成多个 Features，每个 Feature 独立 PR：

**核心机制**：
- 检测复杂需求 → 拆分 Features → 写状态文件
- 每个 Feature 独立执行 p0 流程
- 跨 PR 传递反馈（状态文件记录）
- 提供 `/dev continue` 命令继续下一个 Feature

**状态文件**：`.claude/multi-feature-state.local.md`（官方推荐格式）

**模式切换**：
- 简单任务：自动走单 PR 流程（当前流程）
- 复杂任务：询问是否拆分 → 多 Feature 流程

## 涉及文件

### 修改文件
- `skills/dev/steps/01-prd.md` - 删除"等用户确认"
- `skills/dev/steps/05-code.md` - 删除"停下来，和用户确认"
- `skills/dev/steps/02.5-parallel-detect.md` - 简化或删除
- `skills/dev/SKILL.md` - 添加多 Feature 流程说明

### 新增文件
- `skills/dev/steps/00-feature-detect.md` - Feature 检测与拆分（可选）
- `skills/dev/scripts/feature-split.sh` - Feature 拆分逻辑（可选）
- `skills/dev/scripts/feature-continue.sh` - 继续下一个 Feature

## 成功标准

- [ ] `01-prd.md` 不再包含"等用户确认"
- [ ] `05-code.md` 不再包含"停下来"
- [ ] `02.5-parallel-detect.md` 简化或删除
- [ ] 支持检测复杂需求并拆分 Features
- [ ] 状态文件格式符合官方标准（`.local.md` + YAML frontmatter）
- [ ] `/dev continue` 命令可以继续下一个 Feature
- [ ] 简单任务仍然走当前单 PR 流程（向后兼容）
- [ ] 所有修改通过测试
