# gate:quality - 质量检查 Gate

## 触发时机

Step 7 (Quality) - 代码和测试完成后，PR 创建前

## 审核目标

**在 PR 前发现所有问题**，确保本地检查通过，避免 CI 失败导致的反复修改。

## 核心原则

```
本地先检查 → 本地修复 → 本地再检查 → 通过 → CI（几乎都过）
   ↑_____________本地循环（秒级）_____________↑  只跑一次 CI
```

**不要**：本地不检查 → CI 失败 → 改代码 → CI 再失败 → 循环（每次等 2-3 分钟）

## 审核标准

### 1. TypeCheck (L1-1)

| 检查项 | 命令 | 要求 |
|--------|------|------|
| 类型检查 | `npm run typecheck` | 退出码 0，无类型错误 |

### 2. Unit Tests (L1-2)

| 检查项 | 命令 | 要求 |
|--------|------|------|
| 单元测试 | `npm run test` | 所有测试通过 |

### 3. Build (L1-3)

| 检查项 | 命令 | 要求 |
|--------|------|------|
| 构建检查 | `npm run build` | 构建成功，无错误 |

### 4. Shell Scripts Syntax

| 检查项 | 命令 | 要求 |
|--------|------|------|
| 脚本语法 | `bash -n *.sh` | 所有脚本语法正确 |

## PASS 条件

**所有 4 项检查都通过**：
1. ✅ TypeCheck 通过
2. ✅ Unit Tests 通过
3. ✅ Build 通过
4. ✅ Shell Scripts 语法正确

## FAIL 条件

**任一检查失败**：
- 返回具体错误
- 返回修复建议
- 主 Agent 修复后重新调用 gate:quality
